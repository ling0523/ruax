!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Ruax={})}(this,(function(e){"use strict";e.default=class{constructor(){this.defaults={}}__getValidationConfig(e){if("object"!=typeof e&&(e={},Object.assign(e,this.defaults)),"string"!=typeof e.baseUrl&&(e.baseUrl=this.defaults.baseUrl),"string"!=typeof e.url&&(e.url=this.defaults.url),"object"!=typeof e.data)e.data=this.defaults.data;else{let t=e.data;e.data={},Object.assign(e.data,this.defaults.data),Object.assign(e.data,t)}if(("string"!=typeof e.type||"POST"!=e.type.toLocaleUpperCase()&&"GET"!=e.type.toLocaleUpperCase())&&(e.type=this.defaults.type),("number"!=typeof e.timeout||isNaN(e.timeout))&&(e.timeout=this.defaults.timeout),("string"!=typeof e.dataType||"STRING"!=e.dataType.toLocaleUpperCase()&&"XML"!=e.dataType.toLocaleUpperCase()&&"HTML"!=e.dataType.toLocaleUpperCase()&&"JSON"!=e.dataType.toLocaleUpperCase()&&"BLOB"!=e.dataType.toLocaleUpperCase()&&"JSONP"!=e.dataType.toLocaleUpperCase())&&(e.dataType=this.defaults.dataType),"string"!=typeof e.jsonpCallback&&(e.jsonpCallback=this.defaults.jsonpCallback),"object"!=typeof e.headers)e.headers=this.defaults.headers;else{let t=e.headers;e.headers={},Object.assign(e.headers,this.defaults.headers),Object.assign(e.headers,t)}return"string"!=typeof e.contentType&&!1!==e.contentType&&(e.contentType=this.defaults.contentType),"boolean"!=typeof e.processData&&(e.processData=this.defaults.processData),"boolean"!=typeof e.cache&&(e.cache=this.defaults.cache),"boolean"!=typeof e.async&&(e.async=this.defaults.async),"boolean"!=typeof e.withCredentials&&(e.withCredentials=this.defaults.withCredentials),"function"!=typeof e.beforeSend&&(e.beforeSend=this.defaults.beforeSend),"function"!=typeof e.complete&&(e.complete=this.defaults.complete),"function"!=typeof e.onProgress&&(e.onProgress=this.defaults.onProgress),"function"!=typeof e.cancelRequest&&(e.cancelRequest=this.defaults.cancelRequest),"function"!=typeof e.beforeRequest&&(e.beforeRequest=this.defaults.beforeRequest),"function"!=typeof e.beforeResponse&&(e.beforeResponse=this.defaults.beforeResponse),e}__setDefaults(){"object"!=typeof this.defaults&&(this.defaults={}),"string"!=typeof this.defaults.baseUrl&&(this.defaults.baseUrl=""),"string"!=typeof this.defaults.url&&(this.defaults.url=""),"object"!=typeof this.defaults.data&&(this.defaults.data={}),("string"!=typeof this.defaults.type||"POST"!=this.defaults.type.toLocaleUpperCase()&&"GET"!=this.defaults.type.toLocaleUpperCase())&&(this.defaults.type="GET"),("number"!=typeof this.defaults.timeout||isNaN(this.defaults.timeout))&&(this.defaults.timeout=8e3),("string"!=typeof this.defaults.dataType||"STRING"!=this.defaults.dataType.toLocaleUpperCase()&&"XML"!=this.defaults.dataType.toLocaleUpperCase()&&"HTML"!=this.defaults.dataType.toLocaleUpperCase()&&"JSON"!=this.defaults.dataType.toLocaleUpperCase()&&"BLOB"!=this.defaults.dataType.toLocaleUpperCase()&&"JSONP"!=this.defaults.dataType.toLocaleUpperCase())&&(this.defaults.dataType="JSON"),"string"!=typeof this.defaults.jsonpCallback&&(this.defaults.jsonpCallback="callback"),"object"!=typeof this.defaults.headers&&(this.defaults.headers={}),"string"!=typeof this.defaults.contentType&&!1!==this.defaults.contentType&&(this.defaults.contentType="application/x-www-form-urlencoded"),"boolean"!=typeof this.defaults.processData&&(this.defaults.processData=!0),"boolean"!=typeof this.defaults.cache&&(this.defaults.cache=!0),"boolean"!=typeof this.defaults.async&&(this.defaults.async=!0),"boolean"!=typeof this.defaults.withCredentials&&(this.defaults.withCredentials=!1),"function"!=typeof this.defaults.beforeSend&&(this.defaults.beforeSend=function(){}),"function"!=typeof this.defaults.complete&&(this.defaults.complete=function(){}),"function"!=typeof this.defaults.onProgress&&(this.defaults.onProgress=function(){}),"function"!=typeof this.defaults.cancelRequest&&(this.defaults.cancelRequest=function(){}),"function"!=typeof this.defaults.beforeRequest&&(this.defaults.beforeRequest=function(){}),"function"!=typeof this.defaults.beforeResponse&&(this.defaults.beforeResponse=function(){})}__getParams(e){let t=[];for(let s in e)t.push(encodeURIComponent(s)+"="+encodeURIComponent(e[s]));return t.join("&")}create(e){return this.__setDefaults(),e=(e=this.__getValidationConfig(e)).beforeRequest.apply(this,[e]),new Promise(((t,s)=>{let a=new XMLHttpRequest;if("blob"==e.dataType.toLocaleLowerCase()&&(a.responseType="blob"),a.onreadystatechange=o=>{if(4==a.readyState){if(e.complete.apply(this,[a]),200==a.status){let o;if("json"==e.dataType.toLocaleLowerCase())try{o=JSON.parse(a.responseText)}catch(l){s(l)}else o="xml"==e.dataType.toLocaleLowerCase()?a.responseXML:"html"==e.dataType.toLocaleLowerCase()||"string"==e.dataType?a.responseText:"blob"==e.dataType.toLocaleLowerCase()?a.response:a.responseText;let n=e.beforeResponse.apply(this,[{response:o,xhr:a,config:e}]);t(n instanceof Promise?n:o)}else if(0!=a.status){const o=new Error("Request failed with status code "+a.status);let l=e.beforeResponse.apply(this,[{xhr:a,config:e,error:o}]);l instanceof Promise?t(l):s(o)}}else 1==a.readyState&&e.beforeSend.apply(this,[a])},a.ontimeout=o=>{const l=new Error("timeout of "+e.timeout+"ms exceeded");let n=e.beforeResponse.apply(this,[{xhr:a,config:e,error:l}]);n instanceof Promise?t(n):s(l)},a.upload.onprogress=t=>{e.onProgress.apply(this,[t])},"jsonp"==e.dataType.toLocaleLowerCase()){e.beforeSend.apply(this);let a=("jsonp_"+Math.random()).replace(".",""),o=document.getElementsByTagName("head")[0];e.data[e.jsonpCallback]=a;let l=document.createElement("script");o.appendChild(l),window[a]=s=>{e.complete.apply(this),o.removeChild(l),clearTimeout(l.timer),window[a]=null;let n=e.beforeResponse.apply(this,[{response:s,config:e}]);t(n instanceof Promise?n:s)},(e.baseUrl+e.url).indexOf("?")>-1?l.src=e.baseUrl+e.url+"&"+this.__getParams(e.data):l.src=e.baseUrl+e.url+"?"+this.__getParams(e.data),l.timer=setTimeout((()=>{e.complete.apply(this),window[a]=null,o.removeChild(l);const n=new Error("timeout of "+e.timeout+"ms exceeded");let i=e.beforeResponse.apply(this,{config:e,error:n});i instanceof Promise?t(i):s(n)}),e.timeout)}else{if("get"==e.type.toLocaleLowerCase()){this.__getParams(e.data)?a.open("GET",e.baseUrl+e.url+"?"+this.__getParams(e.data),e.async):a.open("GET",e.baseUrl+e.url,e.async),e.async&&(a.timeout=e.timeout);for(let t in e.headers)a.setRequestHeader(t,e.headers[t]);"string"==typeof e.contentType&&a.setRequestHeader("Content-Type",e.contentType),a.withCredentials=e.withCredentials,a.send(null)}else if("post"==e.type.toLocaleLowerCase()){a.open("POST",e.baseUrl+e.url,e.async),1==e.async&&(a.timeout=e.timeout);for(let t in e.headers)a.setRequestHeader(t,e.headers[t]);"string"==typeof e.contentType&&a.setRequestHeader("Content-Type",e.contentType),e.processData&&(e.data=this.__getParams(e.data)),a.withCredentials=e.withCredentials,a.send(e.data)}const t=function(){a.abort()};e.cancelRequest.apply(this,[t])}}))}post(e,t){let s={url:e,data:t,type:"POST"};return this.create(s)}get(e,t){let s={url:e,data:t,type:"GET"};return this.create(s)}},Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
